<!-- app.js calls this homepage! 
  - make get req in my own API
  - need to make HTTP call to my own server 
-->

<!DOCTYPE html>
<html>
  <head>
    <style>
      /* Set the size of the div element that contains the map */
      #map {
        /* 400px by 100% */
        /* change to fullscreen: 1600px by 1200% when done */
        height: 600px;  /* The height is 400 pixels */
        width: 1000px;  /* The width is the width of the web page */
       }
    </style>
  </head>
  <body>
    <h3>GOOGLE MAPS API!!</h3>
    
    <!--The div element for the map -->
    <div id="map"></div>

    <script>

// fetch func = asynchronous so that all my data is retrieved and completed before initializing map
// json is data type to hold bunch of key values 
async function initData() {
    const response = await fetch('http://localhost:3000/coins/all');
    const json = response.json();
    console.log(json);
    return json;
}

// getting data from my own API (initData()) to build map 
async function initMap(data) {
  var data = await initData();
  console.log(data);

  var dland = {lat: 33.812, lng: -117.918};
  var hypsmtn = {lat: 33.811, lng: -117.918};
  
  // The map, centered at dland
  var map = new google.maps.Map(
      document.getElementById('map'), {zoom: 17, center: dland});

  // iterate through to pinpoint markers
  for (i in data) {
    const currentMarker = {lat: parseFloat(data[i].coln), lng: parseFloat(data[i].colw)};
    console.log(currentMarker);
    var marker2 = new google.maps.Marker({position: currentMarker, map: map});
  }

  var marker = new google.maps.Marker({position: dland, map: map});

}


    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBt2uGZOui5nESr2PwoRVJxP2OUqYA-gp8&callback=initMap">
    </script>

  </body>
</html>


